"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var gestures_1 = require("ui/gestures");
var map_view_model_1 = require("./map-view-model");
var roomMapServiceModule = require("~/services/room-map-service");
var navigationModule = require("~/shared/navigation");
var animationHelperModule = require("~/shared/animation-helper");
var mapViewModel;
function navigatingTo(args) {
    var page = args.object;
    if (page && page.navigationContext) {
        mapViewModel = new map_view_model_1.MapViewModel(page.navigationContext.roomInfo);
    }
    var img = page.getViewById('imgMap');
    img.style.opacity = 0.2;
    img.scaleX = 0.2;
    img.scaleY = 0.2;
    mapViewModel.isLoading = true;
    roomMapServiceModule.getRoomImage(mapViewModel.roomInfo, function (imageSource) {
        mapViewModel.set('image', imageSource);
        mapViewModel.isLoading = false;
        animationHelperModule.fadeZoom(img);
    });
    page.bindingContext = mapViewModel;
}
exports.navigatingTo = navigatingTo;
function backTap(args) {
    navigationModule.goBack();
}
exports.backTap = backTap;
function backSwipe(args) {
    if (args.direction == gestures_1.SwipeDirection.right) {
        navigationModule.goBack();
    }
}
exports.backSwipe = backSwipe;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwLXBhZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJtYXAtcGFnZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLHdDQUFzRjtBQUV0RixtREFBZ0Q7QUFFaEQsa0VBQW9FO0FBQ3BFLHNEQUF3RDtBQUN4RCxpRUFBbUU7QUFFbkUsSUFBSSxZQUEwQixDQUFDO0FBRS9CLHNCQUE2QixJQUFtQjtJQUM1QyxJQUFJLElBQUksR0FBVSxJQUFJLENBQUMsTUFBTSxDQUFDO0lBRTlCLEVBQUUsQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLFlBQVksR0FBRyxJQUFJLDZCQUFZLENBQVcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQy9FLENBQUM7SUFFRCxJQUFNLEdBQUcsR0FBUSxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLEdBQUcsQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLEdBQUcsQ0FBQztJQUN4QixHQUFHLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztJQUNqQixHQUFHLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztJQUNqQixZQUFZLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztJQUU5QixvQkFBb0IsQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxVQUFDLFdBQVc7UUFDakUsWUFBWSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFDdkMsWUFBWSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7UUFFL0IscUJBQXFCLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hDLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLGNBQWMsR0FBRyxZQUFZLENBQUM7QUFDdkMsQ0FBQztBQXJCRCxvQ0FxQkM7QUFFRCxpQkFBd0IsSUFBc0I7SUFDMUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDOUIsQ0FBQztBQUZELDBCQUVDO0FBRUQsbUJBQTBCLElBQTJCO0lBQ2pELEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUkseUJBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ3pDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQzlCLENBQUM7QUFDTCxDQUFDO0FBSkQsOEJBSUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlLCBOYXZpZ2F0ZWREYXRhIH0gZnJvbSAndWkvcGFnZSc7XHJcbmltcG9ydCB7IEdlc3R1cmVFdmVudERhdGEsIFN3aXBlR2VzdHVyZUV2ZW50RGF0YSwgU3dpcGVEaXJlY3Rpb24gfSBmcm9tICd1aS9nZXN0dXJlcyc7XHJcbmltcG9ydCB7IFJvb21JbmZvIH0gZnJvbSAnfi9zaGFyZWQvaW50ZXJmYWNlcyc7XHJcbmltcG9ydCB7IE1hcFZpZXdNb2RlbCB9IGZyb20gJy4vbWFwLXZpZXctbW9kZWwnO1xyXG5cclxuaW1wb3J0ICogYXMgcm9vbU1hcFNlcnZpY2VNb2R1bGUgZnJvbSAnfi9zZXJ2aWNlcy9yb29tLW1hcC1zZXJ2aWNlJztcclxuaW1wb3J0ICogYXMgbmF2aWdhdGlvbk1vZHVsZSBmcm9tICd+L3NoYXJlZC9uYXZpZ2F0aW9uJztcclxuaW1wb3J0ICogYXMgYW5pbWF0aW9uSGVscGVyTW9kdWxlIGZyb20gJ34vc2hhcmVkL2FuaW1hdGlvbi1oZWxwZXInO1xyXG5cclxubGV0IG1hcFZpZXdNb2RlbDogTWFwVmlld01vZGVsO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG5hdmlnYXRpbmdUbyhhcmdzOiBOYXZpZ2F0ZWREYXRhKSB7XHJcbiAgICBsZXQgcGFnZSA9IDxQYWdlPiBhcmdzLm9iamVjdDtcclxuXHJcbiAgICBpZiAocGFnZSAmJiBwYWdlLm5hdmlnYXRpb25Db250ZXh0KSB7XHJcbiAgICAgICAgbWFwVmlld01vZGVsID0gbmV3IE1hcFZpZXdNb2RlbCg8Um9vbUluZm8+cGFnZS5uYXZpZ2F0aW9uQ29udGV4dC5yb29tSW5mbyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaW1nID0gPGFueT5wYWdlLmdldFZpZXdCeUlkKCdpbWdNYXAnKTtcclxuICAgIGltZy5zdHlsZS5vcGFjaXR5ID0gMC4yO1xyXG4gICAgaW1nLnNjYWxlWCA9IDAuMjtcclxuICAgIGltZy5zY2FsZVkgPSAwLjI7XHJcbiAgICBtYXBWaWV3TW9kZWwuaXNMb2FkaW5nID0gdHJ1ZTtcclxuXHJcbiAgICByb29tTWFwU2VydmljZU1vZHVsZS5nZXRSb29tSW1hZ2UobWFwVmlld01vZGVsLnJvb21JbmZvLCAoaW1hZ2VTb3VyY2UpID0+IHtcclxuICAgICAgICBtYXBWaWV3TW9kZWwuc2V0KCdpbWFnZScsIGltYWdlU291cmNlKTtcclxuICAgICAgICBtYXBWaWV3TW9kZWwuaXNMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYW5pbWF0aW9uSGVscGVyTW9kdWxlLmZhZGVab29tKGltZyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwYWdlLmJpbmRpbmdDb250ZXh0ID0gbWFwVmlld01vZGVsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYmFja1RhcChhcmdzOiBHZXN0dXJlRXZlbnREYXRhKSB7XHJcbiAgICBuYXZpZ2F0aW9uTW9kdWxlLmdvQmFjaygpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYmFja1N3aXBlKGFyZ3M6IFN3aXBlR2VzdHVyZUV2ZW50RGF0YSkge1xyXG4gICAgaWYgKGFyZ3MuZGlyZWN0aW9uID09IFN3aXBlRGlyZWN0aW9uLnJpZ2h0KSB7XHJcbiAgICAgICAgbmF2aWdhdGlvbk1vZHVsZS5nb0JhY2soKTtcclxuICAgIH1cclxufVxyXG4iXX0=